<!DOCTYPE html>
<html>
<head>
    <title>Unlocking the Power of the GLR Black London Collection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            color: #333; /* Default text color - you might need to change this if the background is dark */

            /* --- BACKGROUND IMAGE STYLES --- */
            background-image: url('reels.png'); /* Make sure reels.png is in the same directory as this HTML file */
            background-size: cover;          /* Scales the image to cover the entire body */
            background-repeat: no-repeat;    /* Prevents the image from repeating */
            background-position: center center; /* Centers the image */
            background-attachment: fixed;    /* Keeps the background image fixed while scrolling */

            /* Ensure body covers full viewport for absolute positioning of login-container */
            min-height: 100vh;
            position: relative; /* Set position for absolute child centering */
            /* Removed display:flex, justify-content, align-items from body as login-container now uses absolute positioning */
        }

        .login-container {
            max-width: 960px;
            background-color: #fff; /* Opaque white for the login box */
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;

            /* --- RE-CENTERING THE LOGIN DIV --- */
            position: absolute; /* Position relative to the body */
            top: 50%;            /* Move top edge to middle */
            left: 50%;           /* Move left edge to middle */
            transform: translate(-50%, -50%); /* Shift back by half its width/height to truly center */
            margin: auto; /* Fallback/additional centering (less impactful with absolute positioning) */
            /* --- END RE-CENTERING --- */
        }

        /* Styles for the main content layout */
        .main-content-wrapper {
            display: flex; /* Use flexbox */
            max-width: 1400px; /* Wider container to accommodate both */
            margin: 50px auto; /* Centering and spacing for the main content area */

            /* --- Semi-Transparent Background for Main Content --- */
            background-color: rgba(255, 255, 255, 0.8); /* White with 80% opacity */
            /* Optional: Frosted glass effect (check browser support) */
            /* backdrop-filter: blur(8px); */
            /* -webkit-backdrop-filter: blur(8px); */

            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            overflow: hidden; /* Contains floated/flex items */
            min-height: 80vh; /* Give it a minimum height to make the transparency noticeable */
        }

        .video-column {
            flex: 2; /* Takes 2 parts of the available space */
            padding: 20px;
            overflow-y: auto; /* Allows scrolling if video content overflows */
            background-color: rgba(255, 255, 255, 0.0); /* Transparent background for the column itself */
        }

        .article-column {
            flex: 1; /* Takes 1 part of the available space */
            padding: 20px;
            background-color: rgba(249, 249, 249, 0.7); /* Lighter grey with 70% opacity for article */
            border-left: 1px solid rgba(221, 221, 221, 0.5); /* Separator with some transparency */
            overflow-y: scroll; /* Makes the article column independently scrollable */
            max-height: 80vh; /* Set a max height to enable scrolling */
            box-sizing: border-box; /* Include padding in the element's total width and height */
        }

        h1, h2 {
            text-align: center;
            color: #555;
        }

        .article-column h2,
        .article-column h3 {
            text-align: left; /* Adjust heading alignment for the article */
            color: #333; /* Darker color for article headings */
            margin-top: 1.5em; /* Add some space above headings */
            margin-bottom: 0.8em; /* Add some space below headings */
        }

        .login-form {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .login-form input[type="text"] {
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 80%;
            max-width: 300px;
        }

        .login-form button {
            background-color: #007bff;
            color: white; /* Keeping login button text white for readability */
            padding: 10px 20px;
            border: none;
            border-radius: 44px; /* Changed to circular */
            cursor: pointer;
            font-size: 16px;
        }

        .login-form button:hover {
            background-color: #0056b3;
        }

        .login-error {
            color: red;
            text-align: center;
            margin-top: 10px;
        }

        .featured-video {
            margin-bottom: 30px;
            position: relative;
            padding-bottom: 56.25%; /* 16:9 Aspect Ratio */
            height: 0;
            overflow: hidden;
            background-color: #000; /* This still keeps the video player background black */
            border-radius: 8px;
        }

        .featured-video iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        /* --- VIDEO GRID CHANGES --- */
        .video-grid {
            display: grid; /* Changed to grid for array layout */
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); /* 3 columns, responsive */
            gap: 20px; /* Spacing between grid items */
            padding: 0; /* Remove default padding */
        }

        .video-item {
            cursor: pointer;
            border: 1px solid rgba(221, 221, 221, 0.7);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.2s;
            background-color: rgba(249, 249, 249, 0.9); /* Slightly opaque white for video items */
            padding: 15px;
            box-sizing: border-box; /* Include padding in element's total width */
            margin-bottom: 0; /* Removed margin-bottom as gap handles spacing */
        }

        .video-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .video-item-info {
            padding: 0; /* Removed padding here as it's on .video-item now */
        }

        .video-item-info h3 {
            font-size: 1.1em;
            margin: 0 0 5px 0;
            color: #333; /* --- Video Titles are now BLACK/DARK GREY --- */
            white-space: normal;
            word-wrap: break-word; /* Ensure long words break */
        }

        /* Description Truncation & "Read More" Styling */
        .video-item-info p.description {
            font-size: 0.9em;
            color: #666;
            margin: 0 0 10px 0; /* Added margin below description */
            line-height: 1.6; /* Increased line-height to match article */
            white-space: normal;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: justify; /* Justify text to match article style */
        }

        .video-item-info p.description.truncated {
            max-height: 4.2em; /* Approx 3 lines (1.4em * 3) - adjust as needed for new line-height */
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
        }

        .read-more-btn {
            display: inline-block; /* Changed to inline-block for better flow if needed */
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 0.85em;
            padding: 0;
            margin-top: 5px;
            text-align: left;
            text-decoration: underline;
        }

        .read-more-btn:hover {
            color: #0056b3; /* Only change text color on hover for buttons */
            background-color: transparent; /* Ensure background doesn't change for text buttons */
        }

        /* New style for tags */
        .video-tags {
            margin-top: 10px;
            font-size: 0.8em;
            color: #888;
            display: flex;
            flex-wrap: wrap; /* Allow tags to wrap to next line */
            gap: 5px; /* Space between tags */
        }

        .video-tags span {
            background-color: #e0e0e0;
            padding: 3px 8px;
            border-radius: 12px;
            color: #555;
            white-space: nowrap; /* Keep individual tags on one line */
        }

        /* Article specific styles */
        .article-column p,
        .article-column ul,
        .article-column li {
            line-height: 1.6; /* Unified line height for readability */
            margin-bottom: 1em; /* Consistent spacing between paragraphs and list items */
            text-align: justify; /* Justify text for a cleaner look */
            color: #666; /* Match description text color for consistency */
            font-size: 0.9em; /* Match description font size for consistency */
        }
        .article-column ul {
            padding-left: 20px; /* Indent list items */
            margin-bottom: 1em; /* Ensure consistent spacing after the list */
        }
        .article-column li {
            margin-bottom: 0.5em; /* Slightly less space between list items */
        }
        .article-column strong {
            color: #333; /* Darker color for bold text within the article */
        }

        /* Style for reel references - updated for wrapping and spacing */
        .reel-reference {
            font-weight: bold;
            background-color: rgba(255, 0, 0, 0.05); /* Very light red background */
            padding: 2px 5px;
            border-radius: 4px;
            display: inline-block; /* Allows padding/margin and still wraps inline */
            margin: 0 4px 4px 0; /* Added margin for spacing between wrapped elements */
            font-size: 0.95em; /* Slightly larger to enhance visibility */
        }
    </style>
</head>
<body>

    <div class="login-container" id="loginGateway">
        <h1>SYA #BlackLives: The GLR Black London Collection</h1>
        <div class="login-form">
            <input type="text" id="tokenInput" placeholder="Enter credentials">
            <button onclick="attemptLoginWithToken()">Login</button>
            <p id="loginError" class="login-error"></p>
        </div>
    </div>

    <div class="main-content-wrapper" id="mainContentWrapper" style="display: none;">
        <div class="video-column">
            <div class="featured-video">
                <div id="featuredIframe"></div>
            </div>

            <h2>Currently Available Reels</h2>
            <div class="video-grid" id="videoGrid"></div>
        </div>

        <div class="article-column">
            <p>The "GLR Black London" reels offer a vibrant and nuanced historical record, revealing:</p>
            <h3>Political and Social Activism:</h3>
            <p>The archives vividly document the ongoing struggle for civil rights and fair representation in the UK. We see discussions on "race equality, immigration rules, and voting rights for immigrants" amidst "rising racism" and "anticipated violence in 1992" <span class="reel-reference">(BL_005)</span>. The echoes of global movements, like the Rodney King case and subsequent London protests <span class="reel-reference">(BL_020)</span>, highlight interconnectedness. Key moments include the appointment of Herman Ouseley as the first Black chairman of the Commission for Racial Equality <span class="reel-reference">(BL_009)</span> and discussions around police "cultural awareness training" <span class="reel-reference">(BL_014)</span>.</p>
            <h3>Addressing Systemic Racism and Discrimination:</h3>
            <p>The collection unflinchingly exposes systemic issues within British society. The **Criminal Justice System** is a recurring focus, with content examining the "impact of the Criminal Justice Act on Black individuals" <span class="reel-reference">(BL_008)</span> and calls for "anti-racist training" <span class="reel-reference">(BL_020)</span>. For context, in 2022, Black defendants in England and Wales were more likely to receive a custodial sentence than White British defendants, even when controlling for other factors (Ministry of Justice, 2022). Black prisoners also served a greater proportion of their original sentence in custody (68% in 2022) compared to White prisoners (59%). Concerns about **Health Disparities** are explicitly mentioned, particularly "health disparities among Black women" <span class="reel-reference">(BL_008)</span> and within the "justice system" <span class="reel-reference">(BL_004)</span>. For instance, Black women in the UK face an almost three-fold higher risk of maternal mortality compared to White women. We also find evidence of **Underrepresentation**. In the UK Civil Service as of March 2024, only 4.5% of civil servants whose ethnicity was known were Black, compared to 80.7% of the working-age population identifying as White in the 2021 Census. Local "**Housing/Community Issues**" in Brixton <span class="reel-reference">(BL_020)</span> further paint a picture of racial tensions.</p>
            <h3>Powerful Activism & Advocacy:</h3>
            <p>The archives document various forms of community-led initiatives and advocacy. The "**Black Camden Sisters**'" efforts to support women facing domestic violence <span class="reel-reference">(BL_003)</span> and Dr. Abiola's call for "**unity and independent organization within African communities**" <span class="reel-reference">(BL_008)</span> demonstrate powerful agency. Protests for justice reform <span class="reel-reference">(BL_020)</span> are also prominently featured. In London, domestic abuse incidents remain high; for instance, out of nearly 400,000 cases in the past four years, only one in ten led to positive outcomes like a charge or caution.</p>
            <h3>Celebrating Cultural Identity:</h3>
            <p>These materials richly portray Black arts and culture, including ITV's "new projects supporting Black arts and culture" <span class="reel-reference">(BL_009)</span>, the role of "**Black theater**" <span class="reel-reference">(BL_005)</span>, and various African film series <span class="reel-reference">(BL_011)</span>, <span class="reel-reference">(BL_021)</span>. We also see the influence of musical giants like **Fela Kuti** <span class="reel-reference">(BL_009)</span>, whose Afrobeat revolutionized music, and the cinematic impact of figures like **Melvin Van Peebles** <span class="reel-reference">(BL_004)</span>, who pioneered Blaxploitation cinema. The contributions of **Quincy Jones** across music and film are also vital to acknowledge. Discussions on "**Historical Contributions**" <span class="reel-reference">(BL_013)</span> are vital for representation, highlighting "**overlooked achievements**" of Black figures and the need to "recognize Black inventors like **Garrett Morgan** and **Louis Latimer**" <span class="reel-reference">(BL_013)</span>. "**Community Events**" like the Leicester Carnival <span class="reel-reference">(BL_011)</span>, <span class="reel-reference">(BL_021)</span> and the Brixton Song Contest <span class="reel-reference">(BL_015)</span> further celebrating multiculturalism. The **Power of Art and Culture** is a dominant theme across music, film, poetry, and theatre.</p>
            <p>Beyond preservation, the collection offers immense potential for future documentary practice, academic research, and public engagement related to the Black British experience. Key themes include:</p>
            <ul>
                <li><strong>The Continuum of Black Struggle and Resilience:</strong> These archives provide a powerful narrative of ongoing struggle against oppression, interwoven with stories of resilience, advocacy, and cultural celebration within a British context.</li>
                <li><strong>Societal Challenges & Human Stories:</strong> The collection highlights significant societal challenges, from recurring themes of **Domestic Violence** <span class="reel-reference">(BL_003)</span>, <span class="reel-reference">(BL_014)</span>, <span class="reel-reference">(BL_040)</span> and touches on **Mental Health & Addiction** <span class="reel-reference">(BL_027)</span>, <span class="reel-reference">(BL_029)</span>, to **Challenges Faced by Vulnerable Groups** <span class="reel-reference">(BL_012)</span>, <span class="reel-reference">(BL_015)</span>. We also find explorations of **Ethical Dilemmas in Science & Society** <span class="reel-reference">(BL_002)</span>, <span class="reel-reference">(BL_038)</span>, <span class="reel-reference">(BL_039)</span>.</li>
                
                <li><strong>UK Specific Issues & Institutions:</strong> The archives provide granular detail on UK-specific concerns, including **British Politics & Governance** <span class="reel-reference">(BL_004)</span>, <span class="reel-reference">(BL_005)</span>, <span class="reel-reference">(BL_009)</span>, **Police and Community Relations** <span class="reel-reference">(BL_006)</span>, <span class="reel-reference">(BL_026)</span>, and **Infrastructure & Economy** issues <span class="reel-reference">(BL_007)</span>, <span class="reel-reference">(BL_009)</span>, <span class="reel-reference">(BL_012)</span>, <span class="reel-reference">(BL_004)</span>, <span class="reel-reference">(BL_024)</span>, <span class="reel-reference">(BL_029)</span>.</li>
            </ul>
        </div>
    </div>

    <script>
        // !! WARNING: For demonstration purposes only. Do NOT expose your access token in production client-side code. !!
        // !!          For production, implement server-side authentication and API calls to protect your token. !!
        let VIMEO_ACCESS_TOKEN = null;
        const VIMEO_PROJECT_ID = "25424026"; // <--- REPLACE WITH YOUR ACTUAL VIMEO PROJECT ID

        let videoReferenceMap = new Map(); // Global map to store video data by BL_XXX ID

        // --- Login Gateway Functions ---
        async function attemptLoginWithToken() {
            const tokenInput = document.getElementById('tokenInput').value.trim();
            const loginError = document.getElementById('loginError');

            if (!tokenInput) {
                loginError.textContent = "Please enter an access token.";
                return;
            }

            VIMEO_ACCESS_TOKEN = tokenInput;

            try {
                // 1. Validate token by fetching user info (basic check)
                const testUrl = `https://api.vimeo.com/me?fields=uri`;
                const response = await fetch(testUrl, {
                    headers: {
                        'Authorization': `Bearer ${VIMEO_ACCESS_TOKEN}`
                    }
                });

                if (!response.ok) {
                    throw new Error(`Authentication failed (Status: ${response.status}).`);
                }

                // 2. Proceed to fetch and display videos
                document.getElementById('loginGateway').style.display = 'none';
                document.getElementById('mainContentWrapper').style.display = 'flex'; // Changed to mainContentWrapper
                fetchAllVimeoVideosAndDisplay();

            } catch (error) {
                console.error('Login failed:', error);
                let errorMessage = error.message;
                loginError.textContent = `Login failed: ${errorMessage}`;
                VIMEO_ACCESS_TOKEN = null;
            }
        }

        // --- Vimeo API Functions to fetch ALL videos ---
        async function fetchAllVimeoVideosAndDisplay() {
            if (!VIMEO_ACCESS_TOKEN) {
                console.error("No Vimeo access token available. Login required.");
                return;
            }

            let allVideos = [];
            // Request 'embed.html' as it still provides the most complete embed info,
            // even if we're not explicitly using a custom preset ID.
            let currentPageUrl = `https://api.vimeo.com/me/projects/${VIMEO_PROJECT_ID}/videos?fields=uri,name,tags,description,pictures.sizes,embed.html&per_page=100`;

            try {
                while (currentPageUrl) {
                    const response = await fetch(currentPageUrl, {
                        headers: {
                            'Authorization': `Bearer ${VIMEO_ACCESS_TOKEN}`
                        }
                    });

                    if (!response.ok) {
                        if (response.status === 401 || response.status === 403) {
                            document.getElementById('mainContentWrapper').innerHTML = `<p style="color: red; text-align: center;">Access Denied. Your token might be invalid or lack permissions for this project. <br> Please check your token permissions or project ID.</p>`;
                            console.error(`Vimeo API Error: Status ${response.status}. Check token permissions or project ID.`);
                        }
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }

                    const data = await response.json();
                    allVideos = allVideos.concat(data.data);
                    currentPageUrl = data.paging.next;

                    // Optional: Add a small delay between requests to avoid hitting rate limits
                    // if (currentPageUrl) {
                    //      await new Promise(resolve => setTimeout(resolve, 200));
                    // }
                }

                console.log("Total Vimeo Videos fetched:", allVideos.length);
                if (allVideos.length > 0) {
                    console.log("Example of first video's embed.html:", allVideos[0].embed?.html);
                } else {
                    console.log("No videos fetched from the project.");
                }

                displayVideosInPlayerAndGrid(allVideos);
                linkReelReferences(); // Call the new function to link article references

            } catch (error) {
                console.error('Error fetching Vimeo videos:', error);
                document.getElementById('mainContentWrapper').innerHTML = `<p style="color: red; text-align: center;">Failed to load videos. Please check your network, token, or project ID.</p>`;
            }
        }

        function displayVideosInPlayerAndGrid(videos) {
            // Sort videos numerically by the number in their name
            videos.sort((a, b) => {
                const nameA = a.name || "";
                const nameB = b.name || "";
                try {
                    const numA = parseFloat(nameA.replace("BLACKLIVES_BL_", "").replace("_Vimeo", ""));
                    const numB = parseFloat(nameB.replace("BLACKLIVES_BL_", "").replace("_Vimeo", ""));
                    if (!isNaN(numA) && !isNaN(numB)) {
                        return numA - numB;
                    }
                } catch (e) { /* Fallback to string comparison if numerical parsing fails */ }
                return nameA.localeCompare(b.name || "");
            });

            const featuredIframeContainer = document.getElementById('featuredIframe');
            const videoGrid = document.getElementById('videoGrid');

            if (videos.length === 0) {
                featuredIframeContainer.innerHTML = '<p style="text-align: center; color: #666;">No videos found in this project.</p>';
                videoGrid.innerHTML = '';
                return;
            }

            // Populate videoReferenceMap
            videoReferenceMap.clear(); // Clear previous entries
            videos.forEach(video => {
                const videoName = video.name || "";
                const match = videoName.match(/BL_\d+/);
                if (match) {
                    const blId = match[0]; // e.g., "BL_005"
                    videoReferenceMap.set(blId, video);
                }
            });


            const firstVideo = videos[0];
            // Ensure first video is displayed initially
            updateFeaturedPlayer(firstVideo.uri.split('/').pop(), firstVideo.embed?.html);

            videoGrid.innerHTML = ''; // Clear existing grid content

            videos.forEach(video => {
                const videoItem = document.createElement('div');
                videoItem.classList.add('video-item');
                videoItem.dataset.videoId = video.uri.split('/').pop();

                const videoInfo = document.createElement('div');
                videoInfo.classList.add('video-item-info');

                const titleElement = document.createElement('h3');
                titleElement.textContent = video.name.replace(/_Vimeo$/, '');
                videoInfo.appendChild(titleElement);

                const descriptionElement = document.createElement('p');
                descriptionElement.classList.add('description');
                descriptionElement.textContent = video.description || "No description provided.";
                videoInfo.appendChild(descriptionElement);

                const approxMaxChars = 100; // Character limit for truncation
                if (descriptionElement.textContent.length > approxMaxChars) {
                    descriptionElement.classList.add('truncated');
                    const readMoreBtn = document.createElement('button');
                    readMoreBtn.classList.add('read-more-btn');
                    readMoreBtn.textContent = 'Read More';
                    readMoreBtn.addEventListener('click', (event) => {
                        event.stopPropagation(); // Prevent the video item click from firing
                        toggleDescription(descriptionElement, readMoreBtn);
                    });
                    videoInfo.appendChild(readMoreBtn);
                }

                // --- Display Tags ---
                if (video.tags && video.tags.length > 0) {
                    const tagsContainer = document.createElement('div');
                    tagsContainer.classList.add('video-tags');
                    video.tags.forEach(tag => {
                        const tagSpan = document.createElement('span');
                        tagSpan.textContent = tag.name;
                        tagsContainer.appendChild(tagSpan);
                    });
                    videoInfo.appendChild(tagsContainer);
                }

                videoItem.appendChild(videoInfo);

                // Add click listener to whole item to change featured video
                videoItem.addEventListener('click', () => {
                    updateFeaturedPlayer(video.uri.split('/').pop(), video.embed?.html);
                });

                videoGrid.appendChild(videoItem);
            });
        }

        // --- Function to update the featured player ---
        function updateFeaturedPlayer(videoId, embedHtml) {
            const featuredIframeContainer = document.getElementById('featuredIframe');
            featuredIframeContainer.innerHTML = '';

            const videoIframe = document.createElement('iframe');
            let finalVideoSrc = `https://player.vimeo.com/video/${videoId}`; // Default base URL

            // Prioritize parsing SRC from Vimeo's embed.html if available.
            // This is how Vimeo handles embed settings and privacy hashes.
            if (embedHtml) {
                try {
                    const parser = new DOMParser();
                    const doc = parser.parseFromString(embedHtml, 'text/html');
                    const iframeElement = doc.querySelector('iframe');
                    if (iframeElement && iframeElement.src) {
                        finalVideoSrc = iframeElement.src;
                    }
                } catch (e) {
                    console.warn(`WARN: Could not parse embed.html for video ${videoId}. Error: ${e.message}`);
                }
            }

            // Ensure autoplay and loop are always set for the featured player.
            const url = new URL(finalVideoSrc);
            url.searchParams.set('autoplay', '1');
            url.searchParams.set('loop', '0');
            // If you want to explicitly hide byline, portrait, title, add them here:
            // url.searchParams.set('byline', '0');
            // url.searchParams.set('portrait', '0');
            // url.searchParams.set('title', '0');

            finalVideoSrc = url.toString(); // Convert the URL object back to a string

            videoIframe.src = finalVideoSrc;
            videoIframe.frameBorder = '0';
            videoIframe.allow = 'autoplay; fullscreen; picture-in-picture';
            videoIframe.allowFullscreen = true;
            videoIframe.dataset.videoId = videoId;
            featuredIframeContainer.appendChild(videoIframe);

            window.scrollTo({
                top: document.getElementById('featuredIframe').offsetTop - 20,
                behavior: 'smooth'
            });
            console.log(`DEBUG: Player loaded for video ${videoId}. Final SRC: ${finalVideoSrc}.`);
        }


        // --- Helper function to get thumbnail URL (no longer directly used but kept for completeness if needed) ---
        function getThumbnailUrl(pictures) {
            const sortedSizes = pictures.filter(p => p.width).sort((a, b) => b.width - a.width);
            if (sortedSizes.length > 0) {
                const suitableSize = sortedSizes.find(size => size.width >= 640) || sortedSizes[0];
                return suitableSize.link;
            }
            return 'https://via.placeholder.com/640x360?text=No+Thumbnail'; // Generic fallback image
        }

        // --- Helper function to toggle description visibility ---
        function toggleDescription(descriptionElement, buttonElement) {
            if (descriptionElement.classList.contains('truncated')) {
                descriptionElement.classList.remove('truncated');
                buttonElement.textContent = 'Read Less';
            } else {
                descriptionElement.classList.add('truncated');
                buttonElement.textContent = 'Read More';
            }
        }

        // --- Function to link reel references in the article column ---
        function linkReelReferences() {
            const reelReferences = document.querySelectorAll('.article-column .reel-reference');
            reelReferences.forEach(span => {
                const textContent = span.textContent.trim(); // e.g., "(BL_005)"
                const match = textContent.match(/BL_\d+/);
                if (match) {
                    const blId = match[0]; // e.g., "BL_005"
                    const video = videoReferenceMap.get(blId);
                    if (video) {
                        span.style.cursor = 'pointer';
                        span.style.textDecoration = 'underline';
                        span.style.color = '#007bff'; // Blue like a link
                        span.addEventListener('click', (event) => {
                            event.stopPropagation(); // Prevent the video item click from firing
                            updateFeaturedPlayer(video.uri.split('/').pop(), video.embed?.html);
                        });
                        // Add hover effect for consistency with other links
                        span.addEventListener('mouseover', () => {
                            span.style.color = '#0056b3'; // Darker blue on hover
                        });
                        span.addEventListener('mouseout', () => {
                            span.style.color = '#007bff'; // Back to original blue
                        });
                    } else {
                        console.warn(`Video for reference ${blId} not found in collection.`);
                    }
                }
            });
        }
    </script>
</body>
</html>
